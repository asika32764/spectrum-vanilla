{"version":3,"file":"spectrum.min.js","sources":["../src/dom.ts","../src/utils.ts","../src/index.ts"],"sourcesContent":["export function insertAfter<T extends Element>(existingNode: T, newNode: Element): T {\r\n  existingNode.parentNode?.insertBefore(newNode, existingNode.nextSibling);\r\n  return existingNode;\r\n}\r\n\r\nexport function insertBefore<T extends Element>(existingNode: T, newNode: Element): T {\r\n  existingNode.parentNode?.insertBefore(newNode, existingNode);\r\n  return existingNode;\r\n}\r\n\r\nexport function wrap<T extends Element>(ele: T, wrapper: Element): T {\r\n  ele.replaceWith(wrapper);\r\n  wrapper.appendChild(ele);\r\n  return ele;\r\n}\r\n\r\nexport function outerWidthWithMargin(ele: HTMLElement) {\r\n  const style = window.getComputedStyle(ele);\r\n\r\n  return (\r\n    ele.getBoundingClientRect().width +\r\n    parseFloat(style.marginLeft) +\r\n    parseFloat(style.marginRight)\r\n  );\r\n}\r\n","export function html(html: string, doc = document) {\r\n  const div = doc.createElement('div');\r\n  div.innerHTML = html;\r\n  return div.children[0];\r\n}\r\n\r\nexport function camelize(str: string): string {\r\n  return str.replace(/(?:^\\w|[A-Z]|\\b\\w)/g, function (word, index) {\r\n    return index === 0 ? word.toLowerCase() : word.toUpperCase();\r\n  }).replace(/\\s+/g, '');\r\n}\r\n\r\nexport function throttle(func: Function, wait: number, debounce: Function | undefined = undefined) {\r\n  let timeout: any;\r\n  return function () {\r\n    // @ts-ignore\r\n    const context = this, args = arguments;\r\n    const throttler = function () {\r\n      timeout = null;\r\n      func.apply(context, args);\r\n    };\r\n    if (debounce) clearTimeout(timeout);\r\n    if (debounce || !timeout) {\r\n      timeout = setTimeout(throttler, wait);\r\n    }\r\n  };\r\n}\r\n\r\nexport function addClass(ele: HTMLElement, className: string) {\r\n  const classes = className.split(' ').filter((c) => c !== '');\r\n\r\n  if (className !== '' && classes.length) {\r\n    ele.classList.add(...classes);\r\n  }\r\n  return ele;\r\n}\r\n\r\nexport function removeClass(ele: HTMLElement, className: string) {\r\n  const classes = className.split(' ').filter((c) => c !== '');\r\n  if (className !== '' && classes.length) {\r\n    ele.classList.remove(...classes);\r\n  }\r\n  return ele;\r\n}\r\n\r\nexport function toggleClass(\r\n  ele: HTMLElement,\r\n  className: string,\r\n  state: boolean | undefined = undefined\r\n) {\r\n  if (state != undefined) {\r\n    ele.classList.toggle(className, state);\r\n  } else if (state === true) {\r\n    addClass(ele, className);\r\n  } else {\r\n    removeClass(ele, className);\r\n  }\r\n  return ele;\r\n}\r\n\r\nexport function emit(ele: EventTarget, eventName: string, detail: any = {}) {\r\n  const event = new CustomEvent(\r\n    eventName,\r\n    {\r\n      cancelable: true,\r\n      bubbles: true,\r\n      detail,\r\n    },\r\n  );\r\n\r\n  ele.dispatchEvent(event);\r\n\r\n  return event;\r\n}\r\n\r\nexport function eventDelegate(\r\n  ele: HTMLElement,\r\n  eventName: string,\r\n  selector: string,\r\n  listener: Function,\r\n  payload: { [name: string]: any } = {},\r\n) {\r\n  ele.addEventListener(eventName, (e) => {\r\n    if ((e.target as Element).closest(selector)) {\r\n      // @ts-ignore\r\n      e.data = Object.assign({}, e.data || {}, payload);\r\n\r\n      listener(e);\r\n    }\r\n  }, payload);\r\n}\r\n\r\nexport type OffsetCSSOptions = { top?: number, bottom?: number, left?: number, right?: number, using?: Function };\r\n\r\nexport function setElementOffset(\r\n  elem: HTMLElement,\r\n  options: OffsetCSSOptions,\r\n) {\r\n  let curPosition;\r\n  let curTop;\r\n  let curLeft;\r\n  let calculatePosition;\r\n  let position = elem.style.position;\r\n  let curElem = elem;\r\n  let props: OffsetCSSOptions = {};\r\n\r\n  // Set position first, in-case top/left are set even on static elem\r\n  if (position === \"static\") {\r\n    elem.style.position = \"relative\";\r\n  }\r\n\r\n  let curOffset = getElementOffset(curElem);\r\n  let curCSSTop = elem.style.top;\r\n  let curCSSLeft = elem.style.left;\r\n  calculatePosition = (position === \"absolute\" || position === \"fixed\") &&\r\n    (curCSSTop + curCSSLeft).indexOf(\"auto\") > -1;\r\n\r\n  // Need to be able to calculate position if either\r\n  // top or left is auto and position is either absolute or fixed\r\n  if (calculatePosition) {\r\n    curPosition = getElementPosition(curElem);\r\n    curTop = curPosition.top;\r\n    curLeft = curPosition.left;\r\n\r\n  } else {\r\n    curTop = parseFloat(curCSSTop) || 0;\r\n    curLeft = parseFloat(curCSSLeft) || 0;\r\n  }\r\n\r\n  // if (typeof options === 'function') {\r\n  //   options = options.call(elem, Object.assign({}, curOffset)) as OffsetCSSOptions;\r\n  // }\r\n\r\n  if (options.top != null) {\r\n    props.top = (options.top - curOffset.top) + curTop;\r\n  }\r\n  if (options.left != null) {\r\n    props.left = (options.left - curOffset.left) + curLeft;\r\n  }\r\n  \r\n  if (\"using\" in options) {\r\n    options.using.call(elem, props);\r\n  } else {\r\n    for (const k in props) {\r\n      curElem.style.setProperty(k, props[k as keyof typeof props] + 'px');\r\n    }\r\n  }\r\n}\r\n\r\nexport function getElementOffset(el: HTMLElement) {\r\n  const box = el.getBoundingClientRect();\r\n  const docElem = document.documentElement;\r\n  return {\r\n    top: box.top + window.pageYOffset - docElem.clientTop,\r\n    left: box.left + window.pageXOffset - docElem.clientLeft,\r\n  };\r\n}\r\n\r\nexport function getElementPosition(el: HTMLElement) {\r\n  const { top, left } = el.getBoundingClientRect();\r\n  const { marginTop, marginLeft } = getComputedStyle(el);\r\n  return {\r\n    top: top - parseInt(marginTop, 10),\r\n    left: left - parseInt(marginLeft, 10),\r\n  };\r\n}\r\n","/**\r\n * spectrum-vanilla.js\r\n *\r\n * @copyright  Copyright (C) 2023.\r\n * @license    MIT\r\n */\r\n\r\nimport tinycolor, { ColorInput, Instance } from 'tinycolor2';\r\nimport { insertAfter, outerWidthWithMargin, wrap } from './dom';\r\nimport { SpectrumColorFormat, SpectrumOptions, SpectrumLang, SpectrumListener } from './types';\r\nimport {\r\n  addClass,\r\n  emit,\r\n  eventDelegate,\r\n  getElementOffset,\r\n  html,\r\n  OffsetCSSOptions,\r\n  removeClass,\r\n  setElementOffset,\r\n  throttle,\r\n  toggleClass,\r\n} from './utils';\r\n\r\nconst defaultOpts: Partial<SpectrumOptions> = {\r\n\r\n    // Callbacks\r\n    beforeShow: noop,\r\n    move: noop,\r\n    change: noop,\r\n    show: noop,\r\n    hide: noop,\r\n\r\n    // Options\r\n    color: '',\r\n    type: 'component', // text, color, component or flat\r\n    showInput: false,\r\n    allowEmpty: true,\r\n    showButtons: true,\r\n    clickoutFiresChange: true,\r\n    showInitial: false,\r\n    showPalette: true,\r\n    showPaletteOnly: false,\r\n    hideAfterPaletteSelect: false,\r\n    togglePaletteOnly: false,\r\n    showSelectionPalette: true,\r\n    localStorageKey: '',\r\n    appendTo: 'body',\r\n    maxSelectionSize: 8,\r\n    locale: 'en',\r\n    cancelText: 'cancel',\r\n    chooseText: 'choose',\r\n    togglePaletteMoreText: 'more',\r\n    togglePaletteLessText: 'less',\r\n    clearText: 'Clear Color Selection',\r\n    noColorSelectedText: 'No Color Selected',\r\n    preferredFormat: 'name',\r\n    containerClassName: '',\r\n    replacerClassName: '',\r\n    showAlpha: true,\r\n    theme: 'sp-light',\r\n    palette: [\r\n      ['#000000', '#444444', '#5b5b5b', '#999999', '#bcbcbc', '#eeeeee', '#f3f6f4', '#ffffff'],\r\n      ['#f44336', '#744700', '#ce7e00', '#8fce00', '#2986cc', '#16537e', '#6a329f', '#c90076'],\r\n      ['#f4cccc', '#fce5cd', '#fff2cc', '#d9ead3', '#d0e0e3', '#cfe2f3', '#d9d2e9', '#ead1dc'],\r\n      ['#ea9999', '#f9cb9c', '#ffe599', '#b6d7a8', '#a2c4c9', '#9fc5e8', '#b4a7d6', '#d5a6bd'],\r\n      ['#e06666', '#f6b26b', '#ffd966', '#93c47d', '#76a5af', '#6fa8dc', '#8e7cc3', '#c27ba0'],\r\n      ['#cc0000', '#e69138', '#f1c232', '#6aa84f', '#45818e', '#3d85c6', '#674ea7', '#a64d79'],\r\n      ['#990000', '#b45f06', '#bf9000', '#38761d', '#134f5c', '#0b5394', '#351c75', '#741b47'],\r\n      ['#660000', '#783f04', '#7f6000', '#274e13', '#0c343d', '#073763', '#20124d', '#4c1130'],\r\n    ],\r\n    selectionPalette: [] as string[],\r\n    disabled: false,\r\n    offset: null,\r\n  },\r\n  spectrums: any[] = [],\r\n  replaceInput = html(\r\n    [\r\n      '<div class=\\'sp-replacer\\'>',\r\n      '<div class=\\'sp-preview\\'><div class=\\'sp-preview-inner\\'></div></div>',\r\n      '<div class=\\'sp-dd\\'>&#9660;</div>',\r\n      '</div>',\r\n    ].join(''),\r\n  ) as HTMLElement,\r\n  markup = (function () {\r\n    return [\r\n      '<div class=\\'sp-container sp-hidden\\'>',\r\n      '<div class=\\'sp-palette-container\\'>',\r\n      '<div class=\\'sp-palette sp-thumb sp-cf\\'></div>',\r\n      '<div class=\\'sp-palette-button-container sp-cf\\'>',\r\n      '<button type=\\'button\\' class=\\'sp-palette-toggle\\'></button>',\r\n      '</div>',\r\n      '</div>',\r\n      '<div class=\\'sp-picker-container\\'>',\r\n      '<div class=\\'sp-top sp-cf\\'>',\r\n      '<div class=\\'sp-fill\\'></div>',\r\n      '<div class=\\'sp-top-inner\\'>',\r\n      '<div class=\\'sp-color\\'>',\r\n      '<div class=\\'sp-sat\\'>',\r\n      '<div class=\\'sp-val\\'>',\r\n      '<div class=\\'sp-dragger\\'></div>',\r\n      '</div>',\r\n      '</div>',\r\n      '</div>',\r\n      '<div class=\\'sp-clear sp-clear-display\\'>',\r\n      '</div>',\r\n      '<div class=\\'sp-hue\\'>',\r\n      '<div class=\\'sp-slider\\'></div>',\r\n      '</div>',\r\n      '</div>',\r\n      '<div class=\\'sp-alpha\\'><div class=\\'sp-alpha-inner\\'><div class=\\'sp-alpha-handle\\'></div></div></div>',\r\n      '</div>',\r\n      '<div class=\\'sp-input-container sp-cf\\'>',\r\n      '<input class=\\'sp-input\\' type=\\'text\\' spellcheck=\\'false\\'  />',\r\n      '</div>',\r\n      '<div class=\\'sp-initial sp-thumb sp-cf\\'></div>',\r\n      '<div class=\\'sp-button-container sp-cf\\'>',\r\n      '<button class=\\'sp-cancel\\' href=\\'#\\'></button>',\r\n      '<button type=\\'button\\' class=\\'sp-choose\\'></button>',\r\n      '</div>',\r\n      '</div>',\r\n      '</div>',\r\n    ].join('');\r\n  })();\r\n\r\nfunction paletteTemplate(p: ColorInput[], color: ColorInput, className: string, opts: any) {\r\n  const html = [];\r\n  for (let i = 0; i < p.length; i++) {\r\n    const current = p[i];\r\n    if (current) {\r\n      const tiny = tinycolor(current);\r\n      let c = tiny.toHsl().l < 0.5 ? 'sp-thumb-el sp-thumb-dark' : 'sp-thumb-el sp-thumb-light';\r\n      c += (tinycolor.equals(color, current)) ? ' sp-thumb-active' : '';\r\n      const formattedString = tiny.toString(opts.preferredFormat || 'rgb');\r\n      const swatchStyle = 'background-color:' + tiny.toRgbString();\r\n      html.push('<span title=\"' + formattedString + '\" data-color=\"' + tiny.toRgbString() + '\" class=\"' + c + '\"><span class=\"sp-thumb-inner\" style=\"' + swatchStyle + ';\"></span></span>');\r\n    } else {\r\n      html.push('<span class=\"sp-thumb-el sp-clear-display\" ><span class=\"sp-clear-palette-only\" style=\"background-color: transparent;\"></span></span>');\r\n    }\r\n  }\r\n  return '<div class=\\'sp-cf ' + className + '\\'>' + html.join('') + '</div>';\r\n}\r\n\r\nfunction hideAll() {\r\n  for (let i = 0; i < spectrums.length; i++) {\r\n    if (spectrums[i]) {\r\n      spectrums[i].hide();\r\n    }\r\n  }\r\n}\r\n\r\nfunction instanceOptions(options: Partial<SpectrumOptions>, element: HTMLElement): SpectrumOptions {\r\n  // Clone first\r\n  options = Object.assign({}, options);\r\n\r\n  options.locale = options.locale || window.navigator.language;\r\n\r\n  if (typeof options.locale === 'string') {\r\n    if (options.locale) {\r\n      // handle locale like \"zh-TW\" to \"zh-tw\"\r\n      // handle locale like \"fr-FR\" to \"fr\"\r\n      let parts = options.locale.split('-')\r\n        .map((p) => p.toLowerCase());\r\n\r\n      if (parts[0] === parts[1]) {\r\n        parts = [parts[0]];\r\n      }\r\n\r\n      options.locale = parts.join('-');\r\n    }\r\n\r\n    if (options.locale !== 'en' && Spectrum.localization[options.locale]) {\r\n      options = Object.assign({}, options, Spectrum.localization[options.locale]);\r\n    }\r\n  } else {\r\n    options = Object.assign({}, options, options.locale);\r\n  }\r\n\r\n  const opts = Object.assign({}, defaultOpts, element.dataset, options) as SpectrumOptions;\r\n\r\n  opts.callbacks = {\r\n    'move': bind(opts.move as Function, element),\r\n    'change': bind(opts.change as Function, element),\r\n    'show': bind(opts.show as Function, element),\r\n    'hide': bind(opts.hide as Function, element),\r\n    'beforeShow': bind(opts.beforeShow as Function, element),\r\n  };\r\n\r\n  return opts;\r\n}\r\n\r\nfunction spectrum(element: HTMLElement, options: Partial<SpectrumOptions>) {\r\n\r\n  let opts = instanceOptions(options, element),\r\n    type = opts.type,\r\n    flat = (type === 'flat'),\r\n    showSelectionPalette = opts.showSelectionPalette,\r\n    localStorageKey = opts.localStorageKey,\r\n    theme = opts.theme,\r\n    callbacks = opts.callbacks,\r\n    resize = throttle(reflow, 10),\r\n    visible = false,\r\n    isDragging = false,\r\n    dragWidth = 0,\r\n    dragHeight = 0,\r\n    dragHelperHeight = 0,\r\n    slideHeight = 0,\r\n    slideWidth = 0,\r\n    alphaWidth = 0,\r\n    alphaSlideHelperWidth = 0,\r\n    slideHelperHeight = 0,\r\n    currentHue = 0,\r\n    currentSaturation = 0,\r\n    currentValue = 0,\r\n    currentAlpha = 1,\r\n    palette: any = [],\r\n    paletteArray: any[] = [],\r\n    paletteLookup: any = {},\r\n    selectionPalette = opts.selectionPalette.slice(0),\r\n    maxSelectionSize = opts.maxSelectionSize,\r\n    draggingClass = 'sp-dragging',\r\n    abortNextInputChange = false,\r\n    shiftMovementDirection: any = null;\r\n\r\n  const doc = element.ownerDocument;\r\n\r\n  const container = html(markup, doc) as HTMLElement;\r\n  container.classList.add(theme);\r\n  doc.body.appendChild(container);\r\n\r\n  let body = doc.body,\r\n    boundElement: HTMLElement | HTMLInputElement = element,\r\n    disabled = false,\r\n    pickerContainer = container.querySelector('.sp-picker-container') as HTMLElement,\r\n    dragger = container.querySelector('.sp-color') as HTMLElement,\r\n    dragHelper = container.querySelector('.sp-dragger') as HTMLElement,\r\n    slider = container.querySelector('.sp-hue') as HTMLElement,\r\n    slideHelper = container.querySelector('.sp-slider') as HTMLElement,\r\n    alphaSliderInner = container.querySelector('.sp-alpha-inner') as HTMLElement,\r\n    alphaSlider = container.querySelector('.sp-alpha') as HTMLElement,\r\n    alphaSlideHelper = container.querySelector('.sp-alpha-handle') as HTMLElement,\r\n    textInput = container.querySelector('.sp-input') as HTMLInputElement,\r\n    paletteContainer = container.querySelector('.sp-palette') as HTMLElement,\r\n    initialColorContainer = container.querySelector('.sp-initial') as HTMLElement,\r\n    cancelButton = container.querySelector('.sp-cancel') as HTMLElement,\r\n    clearButton = container.querySelector('.sp-clear') as HTMLElement,\r\n    chooseButton = container.querySelector('.sp-choose') as HTMLElement,\r\n    toggleButton = container.querySelector('.sp-palette-toggle') as HTMLElement,\r\n    isInput = boundElement.nodeName === 'INPUT',\r\n    isInputTypeColor = isInput && boundElement.getAttribute('type') === 'color',\r\n    shouldReplace = isInput && (type === 'color' || isInputTypeColor),\r\n    replacer = (shouldReplace)\r\n      ? (() => {\r\n        addClass(replaceInput, theme);\r\n        addClass(replaceInput, opts.replacerClassName);\r\n        return replaceInput;\r\n      })()\r\n      : null,\r\n    offsetElement = (shouldReplace) ? replacer : boundElement,\r\n    previewElement = replacer?.querySelector('.sp-preview-inner') as HTMLElement,\r\n    initialColor = opts.color || (isInput && (boundElement as HTMLInputElement).value),\r\n    colorOnShow: ColorInput = '',\r\n    currentPreferredFormat = opts.preferredFormat,\r\n    clickoutFiresChange = !opts.showButtons || opts.clickoutFiresChange,\r\n    isEmpty = !initialColor,\r\n    allowEmpty = opts.allowEmpty;\r\n\r\n  // Element to be updated with the input color. Populated in initialize method\r\n  let originalInputContainer: HTMLSpanElement;\r\n  let colorizeElement: HTMLElement | null;\r\n  let colorizeElementInitialColor: string;\r\n  let colorizeElementInitialBackground: string;\r\n\r\n  //If there is a label for this element, when clicked on, show the colour picker\r\n  const thisId = boundElement.getAttribute('id') || '';\r\n  if (thisId !== undefined && thisId.length > 0) {\r\n    const labels = document.querySelectorAll(`label[for=\"${thisId}\"]`);\r\n\r\n    labels.forEach((label) => {\r\n      label.addEventListener('click', function (e) {\r\n        e.preventDefault();\r\n        show();\r\n        return false;\r\n      });\r\n    });\r\n  }\r\n\r\n  function applyOptions() {\r\n\r\n    if (opts.showPaletteOnly) {\r\n      opts.showPalette = true;\r\n    }\r\n\r\n    if (toggleButton) {\r\n      toggleButton.textContent = opts.showPaletteOnly ? opts.togglePaletteMoreText : opts.togglePaletteLessText;\r\n    }\r\n\r\n    if (opts.palette) {\r\n      palette = opts.palette.slice(0);\r\n      paletteArray = Array.isArray(palette[0]) ? palette : [palette];\r\n      paletteLookup = {};\r\n      for (let i = 0; i < paletteArray.length; i++) {\r\n        for (let j = 0; j < paletteArray[i].length; j++) {\r\n          const rgb = tinycolor(paletteArray[i][j]).toRgbString();\r\n          paletteLookup[rgb] = true;\r\n        }\r\n      }\r\n\r\n      // if showPaletteOnly and didn't set initialcolor\r\n      // set initialcolor to first palette\r\n      if (opts.showPaletteOnly && !initialColor) {\r\n        initialColor = (palette[0][0] === '') ? palette[0][0] : Object.keys(paletteLookup)[0];\r\n      }\r\n    }\r\n\r\n    toggleClass(container, 'sp-flat', flat);\r\n    toggleClass(container, 'sp-input-disabled', !opts.showInput);\r\n    toggleClass(container, 'sp-alpha-enabled', opts.showAlpha);\r\n    toggleClass(container, 'sp-clear-enabled', allowEmpty);\r\n    toggleClass(container, 'sp-buttons-disabled', !opts.showButtons);\r\n    toggleClass(container, 'sp-palette-buttons-disabled', !opts.togglePaletteOnly);\r\n    toggleClass(container, 'sp-palette-disabled', !opts.showPalette);\r\n    toggleClass(container, 'sp-palette-only', opts.showPaletteOnly);\r\n    toggleClass(container, 'sp-initial-disabled', !opts.showInitial);\r\n    addClass(container, opts.containerClassName);\r\n\r\n    reflow();\r\n  }\r\n\r\n  function offsetElementStart(e: Event) {\r\n    if (!disabled) {\r\n      show();\r\n    }\r\n\r\n    e.stopPropagation();\r\n    const target = e.target as HTMLElement;\r\n\r\n    if (!target.matches('input')) {\r\n      e.preventDefault();\r\n    }\r\n  }\r\n\r\n  function initialize() {\r\n    applyOptions();\r\n    const inputStyle = window.getComputedStyle(boundElement);\r\n\r\n    originalInputContainer = html('<span class=\"sp-original-input-container\"></span>') as HTMLSpanElement;\r\n    ['margin'].forEach((cssProp: string)=> {\r\n      const st = originalInputContainer.style;\r\n      originalInputContainer.style.setProperty(cssProp, inputStyle.getPropertyValue(cssProp));\r\n    });\r\n    // inline-flex by default, switching to flex if needed\r\n\r\n    if (inputStyle.display === 'block') {\r\n      originalInputContainer.style.display = 'flex';\r\n    }\r\n\r\n    if (shouldReplace) {\r\n      insertAfter(boundElement, replacer as Element);\r\n      boundElement.style.display = 'none';\r\n    } else if (type === 'text') {\r\n      addClass(originalInputContainer, 'sp-colorize-container');\r\n      addClass(boundElement, 'spectrum sp-colorize');\r\n      wrap(boundElement, originalInputContainer);\r\n    } else if (type === 'component') {\r\n      addClass(boundElement, 'spectrum');\r\n      wrap(boundElement, originalInputContainer);\r\n      const addOn = html(['<div class=\\'sp-colorize-container sp-add-on\\'>',\r\n        '<div class=\\'sp-colorize\\'></div> ',\r\n        '</div>'].join('')) as HTMLElement;\r\n\r\n      addOn.style.width = boundElement.offsetHeight + 'px';\r\n      addOn.style.borderRadius = inputStyle.borderRadius;\r\n      addOn.style.border = inputStyle.border;\r\n\r\n      boundElement.classList.add('with-add-on');\r\n\r\n      boundElement.before(addOn);\r\n    }\r\n\r\n    colorizeElement = boundElement.parentNode?.querySelector('.sp-colorize');\r\n    colorizeElementInitialColor = colorizeElement?.style.color || '';\r\n    colorizeElementInitialBackground = colorizeElement?.style.backgroundColor || '';\r\n\r\n    if (!allowEmpty) {\r\n      clearButton.style.display = 'none';\r\n    }\r\n\r\n    if (flat) {\r\n      boundElement.after(container);\r\n      boundElement.style.display = 'none';\r\n    } else {\r\n\r\n      let appendTo = opts.appendTo === 'parent' ? boundElement.parentElement : opts.appendTo;\r\n      if (!appendTo) {\r\n        appendTo = document.body;\r\n      }\r\n\r\n      if (typeof appendTo !== 'string') {\r\n        appendTo.append(container);\r\n      }\r\n    }\r\n\r\n    updateSelectionPaletteFromStorage();\r\n\r\n    offsetElement?.addEventListener('click', offsetElementStart);\r\n    offsetElement?.addEventListener('touchstart', offsetElementStart);\r\n\r\n    if (boundElement.matches(':disabled') || opts.disabled) {\r\n      disable();\r\n    }\r\n\r\n    // Prevent clicks from bubbling up to document.  This would cause it to be hidden.\r\n    container.addEventListener('click', (e) => e.stopPropagation());\r\n\r\n    // Handle user typed input\r\n    [textInput, boundElement].forEach(function (input: HTMLElement | HTMLInputElement) {\r\n      if (!('value' in input)) {\r\n        return;\r\n      }\r\n\r\n      input.addEventListener('change', () => {\r\n        setFromTextInput(input.value);\r\n      });\r\n      input.addEventListener('paste', () => {\r\n        setTimeout(() => {\r\n          setFromTextInput(input.value);\r\n        }, 1);\r\n      });\r\n      input.addEventListener('keydown', (e) => {\r\n        if (e.keyCode === 13) {\r\n          setFromTextInput(input.value);\r\n          if (input === boundElement) {\r\n            hide();\r\n          }\r\n        }\r\n      });\r\n    });\r\n\r\n    cancelButton.textContent = opts.cancelText;\r\n    cancelButton.addEventListener('click', function (e) {\r\n      e.stopPropagation();\r\n      e.preventDefault();\r\n      revert();\r\n      hide();\r\n    });\r\n\r\n    clearButton.setAttribute('title', opts.clearText);\r\n    clearButton.addEventListener('click', function (e) {\r\n      e.stopPropagation();\r\n      e.preventDefault();\r\n      isEmpty = true;\r\n      move();\r\n\r\n      if (flat) {\r\n        //for the flat style, this is a change event\r\n        updateOriginalInput(true);\r\n      }\r\n    });\r\n\r\n    chooseButton.textContent = opts.chooseText;\r\n    chooseButton.addEventListener('click', e => {\r\n      e.stopPropagation();\r\n      e.preventDefault();\r\n\r\n      // if (IE && textInput.matches(':focus')) {\r\n      //   textInput.dispatchEvent(new CustomEvent('change'));\r\n      // }\r\n\r\n      if (isValid()) {\r\n        updateOriginalInput(true);\r\n        hide();\r\n      }\r\n    });\r\n\r\n    toggleButton.textContent = opts.showPaletteOnly ? opts.togglePaletteMoreText : opts.togglePaletteLessText;\r\n    toggleButton.addEventListener('click', e => {\r\n      e.stopPropagation();\r\n      e.preventDefault();\r\n\r\n      opts.showPaletteOnly = !opts.showPaletteOnly;\r\n\r\n      // To make sure the Picker area is drawn on the right, next to the\r\n      // Palette area (and not below the palette), first move the Palette\r\n      // to the left to make space for the picker, plus 5px extra.\r\n      // The 'applyOptions' function puts the whole container back into place\r\n      // and takes care of the button-text and the sp-palette-only CSS class.\r\n      if (!opts.showPaletteOnly && !flat) {\r\n        container.style.left = '-=' + (outerWidthWithMargin(pickerContainer) + 5);\r\n      }\r\n      applyOptions();\r\n    });\r\n\r\n    draggable(alphaSlider, function (dragX, dragY, e) {\r\n      currentAlpha = (dragX / alphaWidth);\r\n      isEmpty = false;\r\n      if (e.shiftKey) {\r\n        currentAlpha = Math.round(currentAlpha * 10) / 10;\r\n      }\r\n\r\n      move();\r\n    }, dragStart, dragStop);\r\n\r\n    draggable(slider, function (dragX, dragY) {\r\n      currentHue = dragY / slideHeight;\r\n      isEmpty = false;\r\n      if (!opts.showAlpha) {\r\n        currentAlpha = 1;\r\n      }\r\n      move();\r\n    }, dragStart, dragStop);\r\n\r\n    draggable(dragger, function (dragX, dragY, e) {\r\n\r\n      // shift+drag should snap the movement to either the x or y axis.\r\n      if (!e.shiftKey) {\r\n        shiftMovementDirection = null;\r\n      } else if (!shiftMovementDirection) {\r\n        const oldDragX = currentSaturation * dragWidth;\r\n        const oldDragY = dragHeight - (currentValue * dragHeight);\r\n        const furtherFromX = Math.abs(dragX - oldDragX) > Math.abs(dragY - oldDragY);\r\n\r\n        shiftMovementDirection = furtherFromX ? 'x' : 'y';\r\n      }\r\n\r\n      const setSaturation = !shiftMovementDirection || shiftMovementDirection === 'x';\r\n      const setValue = !shiftMovementDirection || shiftMovementDirection === 'y';\r\n\r\n      if (setSaturation) {\r\n        currentSaturation = (dragX / dragWidth);\r\n      }\r\n      if (setValue) {\r\n        currentValue = ((dragHeight - dragY) / dragHeight);\r\n      }\r\n\r\n      isEmpty = false;\r\n      if (!opts.showAlpha) {\r\n        currentAlpha = 1;\r\n      }\r\n\r\n      move();\r\n\r\n    }, dragStart, dragStop);\r\n\r\n    if (!!initialColor) {\r\n      set(initialColor);\r\n\r\n      // In case color was black - update the preview UI and set the format\r\n      // since the set function will not run (default color is black).\r\n      updateUI();\r\n      currentPreferredFormat = tinycolor(initialColor).getFormat() as SpectrumColorFormat || opts.preferredFormat;\r\n      addColorToSelectionPalette(initialColor);\r\n    } else if (initialColor === '') {\r\n      set(initialColor);\r\n      updateUI();\r\n    } else {\r\n      updateUI();\r\n    }\r\n\r\n    if (flat) {\r\n      show();\r\n    }\r\n\r\n    function paletteElementClick(e: Event) {\r\n      // @ts-ignore\r\n      if (e.data && e.data.ignore) {\r\n        const el = (e.target as HTMLElement).closest('.sp-thumb-el') as HTMLElement | null;\r\n        set(el?.dataset?.color || '');\r\n        move();\r\n      } else {\r\n        const el = (e.target as HTMLElement).closest('.sp-thumb-el') as HTMLElement | null;\r\n        set(el?.dataset?.color || '');\r\n        move();\r\n\r\n        // If the picker is going to close immediately, a palette selection\r\n        // is a change.  Otherwise, it's a move only.\r\n        if (opts.hideAfterPaletteSelect) {\r\n          updateOriginalInput(true);\r\n          hide();\r\n        } else {\r\n          updateOriginalInput();\r\n        }\r\n      }\r\n\r\n      return false;\r\n    }\r\n\r\n    const paletteEvents = ['click', 'touchstart'];\r\n\r\n    for (const paletteEvent of paletteEvents) {\r\n      eventDelegate(paletteContainer, paletteEvent, '.sp-thumb-el', paletteElementClick);\r\n      eventDelegate(initialColorContainer, paletteEvent, '.sp-thumb-el:nth-child(1)', paletteElementClick, { ignore: true });\r\n    }\r\n  }\r\n\r\n  function updateSelectionPaletteFromStorage() {\r\n    if (localStorageKey) {\r\n      // Migrate old palettes over to new format.  May want to remove this eventually.\r\n      try {\r\n        const localStorage = window.localStorage;\r\n        const oldPalette = localStorage[localStorageKey].split(',#');\r\n        if (oldPalette.length > 1) {\r\n          delete localStorage[localStorageKey];\r\n\r\n          for (const c of oldPalette) {\r\n            addColorToSelectionPalette(c);\r\n          }\r\n        }\r\n      } catch (e) {\r\n      }\r\n\r\n      try {\r\n        selectionPalette = window.localStorage[localStorageKey].split(';');\r\n      } catch (e) {\r\n      }\r\n    }\r\n  }\r\n\r\n  function addColorToSelectionPalette(color: ColorInput) {\r\n    if (showSelectionPalette) {\r\n      const rgb = tinycolor(color).toRgbString();\r\n\r\n      if (!paletteLookup[rgb] && !selectionPalette.includes(rgb)) {\r\n        selectionPalette.push(rgb);\r\n        while (selectionPalette.length > maxSelectionSize) {\r\n          selectionPalette.shift();\r\n        }\r\n      }\r\n\r\n      if (localStorageKey) {\r\n        try {\r\n          window.localStorage[localStorageKey] = selectionPalette.join(';');\r\n        } catch (e) {\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  function getUniqueSelectionPalette() {\r\n    var unique = [];\r\n    if (opts.showPalette) {\r\n      for (var i = 0; i < selectionPalette.length; i++) {\r\n        var rgb = tinycolor(selectionPalette[i]).toRgbString();\r\n\r\n        if (!paletteLookup[rgb]) {\r\n          unique.push(selectionPalette[i]);\r\n        }\r\n      }\r\n    }\r\n\r\n    return unique.reverse().slice(0, opts.maxSelectionSize);\r\n  }\r\n\r\n  function drawPalette() {\r\n\r\n    const currentColor = get();\r\n\r\n    const html = paletteArray.map((palette, i) => {\r\n      return paletteTemplate(palette, currentColor, 'sp-palette-row sp-palette-row-' + i, opts);\r\n    });\r\n\r\n    updateSelectionPaletteFromStorage();\r\n\r\n    if (selectionPalette) {\r\n      html.push(paletteTemplate(getUniqueSelectionPalette(), currentColor, 'sp-palette-row sp-palette-row-selection', opts));\r\n    }\r\n\r\n    paletteContainer.innerHTML = html.join('');\r\n  }\r\n\r\n  function drawInitial() {\r\n    if (opts.showInitial) {\r\n      const initial = colorOnShow;\r\n      const current = get();\r\n      initialColorContainer.innerHTML = paletteTemplate([initial, current], current, 'sp-palette-row-initial', opts);\r\n    }\r\n  }\r\n\r\n  function dragStart() {\r\n    if (dragHeight <= 0 || dragWidth <= 0 || slideHeight <= 0) {\r\n      reflow();\r\n    }\r\n    isDragging = true;\r\n    addClass(container, draggingClass);\r\n    shiftMovementDirection = null;\r\n\r\n    emit(boundElement, 'dragstart', { color: get() });\r\n  }\r\n\r\n  function dragStop() {\r\n    isDragging = false;\r\n    removeClass(container, draggingClass);\r\n    emit(boundElement, 'dragstop', { color: get() });\r\n  }\r\n\r\n  function setFromTextInput(value: string) {\r\n    if (abortNextInputChange) {\r\n      abortNextInputChange = false;\r\n      return;\r\n    }\r\n    if ((value === null || value === '') && allowEmpty) {\r\n      set('');\r\n      move();\r\n      updateOriginalInput();\r\n    } else {\r\n      const tiny = tinycolor(value);\r\n      if (tiny.isValid()) {\r\n        set(tiny);\r\n        move();\r\n        updateOriginalInput();\r\n      } else {\r\n        textInput.classList.add('sp-validation-error');\r\n      }\r\n    }\r\n  }\r\n\r\n  function toggle() {\r\n    if (visible) {\r\n      hide();\r\n    } else {\r\n      show();\r\n    }\r\n  }\r\n\r\n  function show() {\r\n    if (visible) {\r\n      reflow();\r\n      return;\r\n    }\r\n\r\n    const event = emit(boundElement, 'beforeShow', { color: get() });\r\n\r\n    if (callbacks.beforeShow(event) === false || event.defaultPrevented) {\r\n      return;\r\n    }\r\n\r\n    hideAll();\r\n    visible = true;\r\n\r\n    doc.addEventListener('keydown', onkeydown);\r\n    doc.addEventListener('click', clickout);\r\n    window.addEventListener('resize', resize);\r\n    replacer?.classList.add('sp-active');\r\n    container.classList.remove('sp-hidden');\r\n\r\n    reflow();\r\n    updateUI();\r\n\r\n    colorOnShow = get();\r\n\r\n    drawInitial();\r\n\r\n    const e = emit(boundElement, 'show', { color: colorOnShow });\r\n    callbacks.show(e);\r\n  }\r\n\r\n  function onkeydown(e: KeyboardEvent) {\r\n    // Close on ESC\r\n    if (e.keyCode === 27) {\r\n      hide();\r\n    }\r\n  }\r\n\r\n  function clickout(e: MouseEvent) {\r\n    // Return on right click.\r\n    if (e.button == 2) {\r\n      return;\r\n    }\r\n\r\n    // If a drag event was happening during the mouseup, don't hide\r\n    // on click.\r\n    if (isDragging) {\r\n      return;\r\n    }\r\n\r\n    if (clickoutFiresChange) {\r\n      updateOriginalInput(true);\r\n    } else {\r\n      revert();\r\n    }\r\n    hide();\r\n  }\r\n\r\n  function hide() {\r\n    // Return if hiding is unnecessary\r\n    if (!visible || flat) {\r\n      return;\r\n    }\r\n    visible = false;\r\n\r\n    doc.removeEventListener('keydown', onkeydown);\r\n    doc.removeEventListener('click', clickout);\r\n    window.removeEventListener('resize', resize);\r\n\r\n    replacer?.classList.remove('sp-active');\r\n    container.classList.add('sp-hidden');\r\n\r\n    const event = emit(boundElement, 'hide', { color: get() });\r\n    callbacks.hide(event);\r\n  }\r\n\r\n  function revert() {\r\n    set(colorOnShow, true);\r\n    updateOriginalInput(true);\r\n  }\r\n\r\n  function set(color: ColorInput, ignoreFormatChange: boolean = false) {\r\n    if (tinycolor.equals(color, get())) {\r\n      // Update UI just in case a validation error needs\r\n      // to be cleared.\r\n      updateUI();\r\n      return;\r\n    }\r\n\r\n    var newColor, newHsv;\r\n    if ((!color || color === undefined) && allowEmpty) {\r\n      isEmpty = true;\r\n    } else {\r\n      isEmpty = false;\r\n      newColor = tinycolor(color);\r\n      newHsv = newColor.toHsv();\r\n\r\n      currentHue = (newHsv.h % 360) / 360;\r\n      currentSaturation = newHsv.s;\r\n      currentValue = newHsv.v;\r\n      currentAlpha = newHsv.a;\r\n    }\r\n    updateUI();\r\n\r\n    if (newColor && newColor.isValid() && !ignoreFormatChange) {\r\n      currentPreferredFormat = opts.preferredFormat || newColor.getFormat() as SpectrumColorFormat;\r\n    }\r\n  }\r\n\r\n  function get(opts: any = {}): Instance | '' {\r\n    if (allowEmpty && isEmpty) {\r\n      return '';\r\n    }\r\n\r\n    return tinycolor.fromRatio({\r\n      h: currentHue,\r\n      s: currentSaturation,\r\n      v: currentValue,\r\n      a: Math.round(currentAlpha * 1000) / 1000,\r\n      // @ts-ignore\r\n    }, { format: opts.format || currentPreferredFormat });\r\n  }\r\n\r\n  function isValid() {\r\n    return !textInput.classList.contains('sp-validation-error');\r\n  }\r\n\r\n  function move() {\r\n    updateUI();\r\n\r\n    const event = emit(boundElement, 'move', { color: get() });\r\n    callbacks.move(event);\r\n  }\r\n\r\n  function updateUI() {\r\n\r\n    textInput.classList.remove('sp-validation-error');\r\n\r\n    updateHelperLocations();\r\n\r\n    // Update dragger background color (gradients take care of saturation and value).\r\n    const flatColor = tinycolor.fromRatio({ h: currentHue, s: 1, v: 1 });\r\n    dragger.style.backgroundColor = flatColor.toHexString();\r\n\r\n    // Get a format that alpha will be included in (hex and names ignore alpha)\r\n    let format = currentPreferredFormat;\r\n    if (currentAlpha < 1 && !(currentAlpha === 0 && format === 'name')) {\r\n      if (format === 'hex' || format === 'hex3' || format === 'hex6' || format === 'name') {\r\n        format = 'rgb';\r\n      }\r\n    }\r\n\r\n    let realColor = get({ format }),\r\n      displayColor = '';\r\n\r\n    //reset background info for preview element\r\n    if (previewElement) {\r\n      previewElement.classList.remove('sp-clear-display');\r\n      previewElement.style.backgroundColor = 'transparent';\r\n    }\r\n\r\n    if (realColor === '') {\r\n      // Update the replaced elements background with icon indicating no color selection\r\n      previewElement?.classList.add('sp-clear-display');\r\n    } else {\r\n      const realHex = realColor.toHexString();\r\n      const realRgb = realColor.toRgbString();\r\n\r\n      if (previewElement) {\r\n        // Update the replaced elements background color (with actual selected color)\r\n        if (realColor.getAlpha() === 1) {\r\n          previewElement.style.backgroundColor = realRgb;\r\n        } else {\r\n          previewElement.style.backgroundColor = 'transparent';\r\n          previewElement.style.filter = realColor.toFilter();\r\n        }\r\n      }\r\n\r\n      if (opts.showAlpha) {\r\n        const rgb = realColor.toRgb();\r\n        rgb.a = 0;\r\n        const realAlpha = tinycolor(rgb).toRgbString();\r\n\r\n        alphaSliderInner.style.background = `linear-gradient(to right, ${realAlpha}, ${realHex})`;\r\n      }\r\n\r\n      displayColor = realColor.toString(format);\r\n    }\r\n\r\n    // Update the text entry input as it changes happen\r\n    if (opts.showInput) {\r\n      textInput.value = displayColor;\r\n    }\r\n    (boundElement as HTMLInputElement).value = displayColor;\r\n    if (opts.type == 'text' || opts.type == 'component') {\r\n      const color = realColor;\r\n      if (color && colorizeElement) {\r\n        const textColor = (color.isLight() || color.getAlpha() < 0.4) ? 'black' : 'white';\r\n        colorizeElement.style.backgroundColor = color.toRgbString();\r\n        colorizeElement.style.color = textColor;\r\n      } else if (colorizeElement) {\r\n        colorizeElement.style.backgroundColor = colorizeElementInitialBackground;\r\n        colorizeElement.style.color = colorizeElementInitialColor;\r\n      }\r\n    }\r\n\r\n    if (opts.showPalette) {\r\n      drawPalette();\r\n    }\r\n\r\n    drawInitial();\r\n  }\r\n\r\n  function updateHelperLocations() {\r\n    if (allowEmpty && isEmpty) {\r\n      //if selected color is empty, hide the helpers\r\n      alphaSlideHelper.style.display = 'none';\r\n      slideHelper.style.display = 'none';\r\n      dragHelper.style.display = 'none';\r\n    } else {\r\n      //make sure helpers are visible\r\n      alphaSlideHelper.style.display = 'block';\r\n      slideHelper.style.display = 'block';\r\n      dragHelper.style.display = 'block';\r\n\r\n      // Where to show the little circle in that displays your current selected color\r\n      let dragX = currentSaturation * dragWidth;\r\n      let dragY = dragHeight - (currentValue * dragHeight);\r\n      dragX = Math.max(\r\n        -dragHelperHeight,\r\n        Math.min(dragWidth - dragHelperHeight, dragX - dragHelperHeight),\r\n      );\r\n      dragY = Math.max(\r\n        -dragHelperHeight,\r\n        Math.min(dragHeight - dragHelperHeight, dragY - dragHelperHeight),\r\n      );\r\n      dragHelper.style.top = dragY + 'px';\r\n      dragHelper.style.left = dragX + 'px';\r\n\r\n      const alphaX = currentAlpha * alphaWidth;\r\n      alphaSlideHelper.style.left = (alphaX - (alphaSlideHelperWidth / 2)) + 'px';\r\n\r\n      // Where to show the bar that displays your current selected hue\r\n      const slideY = (currentHue) * slideHeight;\r\n      slideHelper.style.top = (slideY - slideHelperHeight) + 'px';\r\n    }\r\n  }\r\n\r\n  function updateOriginalInput(fireCallback = false) {\r\n    let color = get(),\r\n      displayColor = '',\r\n      hasChanged = !tinycolor.equals(color, colorOnShow);\r\n\r\n    if (color) {\r\n      displayColor = color.toString(currentPreferredFormat);\r\n      // Update the selection palette with the current color\r\n      addColorToSelectionPalette(color);\r\n    }\r\n\r\n    if (fireCallback && hasChanged) {\r\n      // we trigger the change event or input, but the input change event is also binded\r\n      // to some spectrum processing, that we do no need\r\n      abortNextInputChange = true;\r\n      const event = emit(boundElement, 'change', { color });\r\n      callbacks.change(event);\r\n    }\r\n  }\r\n\r\n  function reflow() {\r\n    if (!visible) {\r\n      return; // Calculations would be useless and wouldn't be reliable anyways\r\n    }\r\n\r\n    dragWidth = dragger.getBoundingClientRect().width;\r\n    dragHeight = dragger.getBoundingClientRect().height;\r\n\r\n    dragHelperHeight = dragHelper.getBoundingClientRect().height;\r\n    slideWidth = slider.getBoundingClientRect().width;\r\n    slideHeight = slider.getBoundingClientRect().height;\r\n    slideHelperHeight = slideHelper.getBoundingClientRect().height;\r\n    alphaWidth = alphaSlider.getBoundingClientRect().width;\r\n    alphaSlideHelperWidth = alphaSlideHelper.getBoundingClientRect().width;\r\n\r\n    if (!flat) {\r\n      container.style.position = 'absolute';\r\n\r\n      if (opts.offset) {\r\n        setElementOffset(container, opts.offset);\r\n      } else {\r\n        setElementOffset(container, getOffset(container, offsetElement as HTMLElement));\r\n      }\r\n    }\r\n\r\n    updateHelperLocations();\r\n\r\n    if (opts.showPalette) {\r\n      drawPalette();\r\n    }\r\n\r\n    emit(boundElement, 'reflow');\r\n  }\r\n\r\n  function destroy() {\r\n    delete boundElement.style.display;\r\n    boundElement.classList.remove('spectrum', 'with-add-on', 'sp-colorize');\r\n    offsetElement.removeEventListener('click', offsetElementStart);\r\n    offsetElement.removeEventListener('touchstart', offsetElementStart);\r\n    container.remove();\r\n    replacer?.remove();\r\n    if (colorizeElement) {\r\n      colorizeElement.style.backgroundColor = colorizeElementInitialBackground;\r\n      colorizeElement.style.color = colorizeElementInitialColor;\r\n    }\r\n    const originalInputContainer = boundElement.closest('.sp-original-input-container');\r\n    if (originalInputContainer) {\r\n      originalInputContainer.after(boundElement);\r\n      originalInputContainer.remove();\r\n    }\r\n    spectrums[spect.id] = null;\r\n  }\r\n\r\n  function option<T extends keyof SpectrumOptions>(\r\n    optionName: T | undefined = undefined,\r\n    optionValue: SpectrumOptions[T] = undefined\r\n  ) {\r\n    if (optionName === undefined) {\r\n      return Object.assign({}, opts);\r\n    }\r\n    if (optionValue === undefined) {\r\n      return opts[optionName];\r\n    }\r\n\r\n    opts[optionName] = optionValue;\r\n\r\n    if (optionName === 'preferredFormat') {\r\n      currentPreferredFormat = opts.preferredFormat;\r\n    }\r\n    applyOptions();\r\n  }\r\n\r\n  function enable() {\r\n    disabled = false;\r\n    (boundElement as HTMLInputElement).disabled = false;\r\n    offsetElement.classList.remove('sp-disabled');\r\n  }\r\n\r\n  function disable() {\r\n    hide();\r\n    disabled = true;\r\n    (boundElement as HTMLInputElement).disabled = true;\r\n    offsetElement.classList.add('sp-disabled');\r\n  }\r\n\r\n  function setOffset(coord: OffsetCSSOptions) {\r\n    opts.offset = coord;\r\n    reflow();\r\n  }\r\n\r\n  initialize();\r\n\r\n  let spect = {\r\n    id: 0,\r\n    show: show,\r\n    hide: hide,\r\n    toggle: toggle,\r\n    reflow: reflow,\r\n    option: option,\r\n    enable: enable,\r\n    disable: disable,\r\n    offset: setOffset,\r\n    set: function (c: ColorInput) {\r\n      set(c);\r\n      updateOriginalInput();\r\n    },\r\n    get: get,\r\n    destroy: destroy,\r\n    container: container,\r\n  };\r\n\r\n  spect.id = spectrums.push(spect) - 1;\r\n\r\n  return spect;\r\n}\r\n\r\n/**\r\n * checkOffset - get the offset below/above and left/right element depending on screen position\r\n * Thanks https://github.com/jquery/jquery-ui/blob/master/ui/jquery.ui.datepicker.js\r\n */\r\nfunction getOffset(picker: HTMLElement, input: HTMLElement) {\r\n  const extraY = 0;\r\n  const dpWidth = picker.offsetWidth;\r\n  const dpHeight = picker.offsetHeight;\r\n  const inputHeight = input.offsetHeight;\r\n  const doc = picker.ownerDocument;\r\n  const docElem = doc.documentElement;\r\n  const viewWidth = docElem.clientWidth + window.pageXOffset;\r\n  const viewHeight = docElem.clientHeight + window.pageYOffset;\r\n  const offset = getElementOffset(input);\r\n  let offsetLeft = offset.left;\r\n  let offsetTop = offset.top;\r\n\r\n  offsetTop += inputHeight;\r\n\r\n  offsetLeft -=\r\n    Math.min(offsetLeft, (offsetLeft + dpWidth > viewWidth && viewWidth > dpWidth) ?\r\n      Math.abs(offsetLeft + dpWidth - viewWidth) : 0);\r\n\r\n  offsetTop -=\r\n    Math.min(offsetTop, ((offsetTop + dpHeight > viewHeight && viewHeight > dpHeight) ?\r\n      Math.abs(dpHeight + inputHeight - extraY) : extraY));\r\n\r\n  return {\r\n    top: offsetTop,\r\n    // bottom: offset.bottom,\r\n    left: offsetLeft,\r\n    // right: offset.right,\r\n    // width: offset.width,\r\n    // height: offset.height\r\n  };\r\n}\r\n\r\n/**\r\n * noop - do nothing\r\n */\r\nfunction noop() {\r\n\r\n}\r\n\r\n/**\r\n * Create a function bound to a given object\r\n * Thanks to underscore.js\r\n */\r\nfunction bind(func: Function, obj: object) {\r\n  const slice = Array.prototype.slice;\r\n  const args = slice.call(arguments, 2);\r\n  return function () {\r\n    return func.apply(obj, args.concat(slice.call(arguments)));\r\n  };\r\n}\r\n\r\n/**\r\n * Lightweight drag helper.  Handles containment within the element, so that\r\n * when dragging, the x is within [0,element.width] and y is within [0,element.height]\r\n */\r\nfunction draggable(\r\n  element: HTMLElement,\r\n  onmove: (x: number, y: number, e: DragEvent) => void,\r\n  onstart: (x: number, y: number, e: DragEvent) => void,\r\n  onstop: (x: number, y: number, e: DragEvent) => void,\r\n) {\r\n  onmove = onmove || noop;\r\n  onstart = onstart || noop;\r\n  onstop = onstop || noop;\r\n  const doc = document;\r\n  let dragging = false;\r\n  let offset: OffsetCSSOptions = {};\r\n  let maxHeight = 0;\r\n  let maxWidth = 0;\r\n  const hasTouch = ('ontouchstart' in window);\r\n\r\n  const duringDragEvents: { [P in keyof HTMLElementEventMap]?: EventListenerOrEventListenerObject; } = {};\r\n  duringDragEvents['selectstart'] = prevent;\r\n  duringDragEvents['dragstart'] = prevent;\r\n  duringDragEvents['touchmove'] = move;\r\n  duringDragEvents['mousemove'] = move;\r\n  duringDragEvents['touchend'] = stop;\r\n  duringDragEvents['mouseup'] = stop;\r\n\r\n  function prevent(e: Event) {\r\n    if (e.stopPropagation) {\r\n      e.stopPropagation();\r\n    }\r\n    if (e.preventDefault) {\r\n      e.preventDefault();\r\n    }\r\n    e.returnValue = false;\r\n  }\r\n\r\n  function move(e: TouchEvent | MouseEvent) {\r\n    if (dragging) {\r\n      const t0 = 'touches' in e && e.touches[0];\r\n      const pageX = t0 && t0.pageX || (e as MouseEvent).pageX;\r\n      const pageY = t0 && t0.pageY || (e as MouseEvent).pageY;\r\n\r\n      const dragX = Math.max(0, Math.min(pageX - offset.left, maxWidth));\r\n      const dragY = Math.max(0, Math.min(pageY - offset.top, maxHeight));\r\n\r\n      if (hasTouch) {\r\n        // Stop scrolling in iOS\r\n        prevent(e);\r\n      }\r\n\r\n      onmove.apply(element, [dragX, dragY, e]);\r\n    }\r\n  }\r\n\r\n  function start(e: TouchEvent | MouseEvent) {\r\n    const rightclick = (e.which) ? (e.which == 3) : ((e as MouseEvent).button === 2);\r\n\r\n    if (!rightclick && !dragging) {\r\n      if (onstart.apply(element, arguments) !== false) {\r\n        dragging = true;\r\n        maxHeight = element.getBoundingClientRect().height;\r\n        maxWidth = element.getBoundingClientRect().width;\r\n        offset = getElementOffset(element);\r\n\r\n        for (const eventName in duringDragEvents) {\r\n          doc.addEventListener(eventName, duringDragEvents[eventName as keyof typeof duringDragEvents]);\r\n        }\r\n\r\n        doc.body.classList.add('sp-dragging');\r\n\r\n        move(e);\r\n\r\n        prevent(e);\r\n      }\r\n    }\r\n  }\r\n\r\n  function stop() {\r\n    if (dragging) {\r\n      for (const eventName in duringDragEvents) {\r\n        doc.removeEventListener(eventName, duringDragEvents[eventName as keyof typeof duringDragEvents]);\r\n      }\r\n      doc.body.classList.remove('sp-dragging');\r\n\r\n      // Wait a tick before notifying observers to allow the click event\r\n      // to fire in Chrome.\r\n      setTimeout(function () {\r\n        onstop.apply(element, arguments);\r\n      }, 0);\r\n    }\r\n    dragging = false;\r\n  }\r\n\r\n  element.addEventListener('touchstart', start);\r\n  element.addEventListener('mousedown', start);\r\n}\r\n\r\nexport default class Spectrum {\r\n  private spectrum: any;\r\n  public ele: HTMLElement;\r\n  public options: Partial<SpectrumOptions>;\r\n  public eventListeners: { [event: string]: EventListener[] } = {};\r\n\r\n  static defaultOptions = defaultOpts;\r\n  static draggable = draggable;\r\n  static localization: { [locale: string]: SpectrumLang } = {};\r\n  static palette: string[][] = [];\r\n\r\n  static create(selector: string | HTMLElement, options: Partial<SpectrumOptions> = {}): Spectrum {\r\n    const ele = this.wrap(selector);\r\n\r\n    if (!ele) {\r\n      let msg = 'Unable to find element';\r\n\r\n      if (typeof selector === 'string') {\r\n        msg += ' - Selector: ' + selector;\r\n      }\r\n      throw Error(msg);\r\n    }\r\n\r\n    return new this(ele, options);\r\n  }\r\n\r\n  static createIfExists(selector: string | HTMLElement, options: Partial<SpectrumOptions> = {}): Spectrum|null {\r\n    const ele = this.wrap(selector);\r\n\r\n    if (!ele) {\r\n      return null;\r\n    }\r\n\r\n    return new this(ele, options);\r\n  }\r\n\r\n  static getInstance(selector: string | HTMLElement, options: Partial<SpectrumOptions> = {}): Spectrum {\r\n    const ele = this.wrap(selector);\r\n\r\n    // @ts-ignore\r\n    return ele.__spectrum = ele.__spectrum || this.createIfExists(ele, options);\r\n  }\r\n\r\n  static hasInstance(selector: string | HTMLElement) {\r\n    const ele = this.wrap(selector);\r\n\r\n    // @ts-ignore\r\n    return ele.__spectrum !== undefined;\r\n  }\r\n\r\n  static createMultiple(\r\n    selector: string | NodeListOf<HTMLElement>,\r\n    options: Partial<SpectrumOptions> = {}\r\n  ) {\r\n    const instances: Spectrum[] = [];\r\n\r\n    this.wrapList(selector).forEach((ele) => {\r\n      instances.push(this.create(ele, options));\r\n    });\r\n\r\n    return instances;\r\n  }\r\n\r\n  static getInstanceMultiple(\r\n    selector: string | JQuery | NodeListOf<HTMLElement>,\r\n    options: Partial<SpectrumOptions> = {},\r\n  ) {\r\n    const instances: Spectrum[] = [];\r\n\r\n    this.wrapList(selector).forEach((ele) => {\r\n      instances.push(this.getInstance(ele, options));\r\n    });\r\n\r\n    return instances;\r\n  }\r\n\r\n  private static wrap(selector: string | JQuery | HTMLElement): HTMLElement|null {\r\n    if (typeof selector === 'string') {\r\n      return document.querySelector<HTMLElement>(selector);\r\n    } else if ((selector as JQuery).jquery) {\r\n      return (selector as JQuery)[0];\r\n    } else {\r\n      return selector as HTMLElement;\r\n    }\r\n  }\r\n\r\n  private static wrapList(selector: string | JQuery | NodeListOf<HTMLElement>): Array<HTMLElement> {\r\n    if (typeof selector === 'string') {\r\n      return Array.from(document.querySelectorAll<HTMLElement>(selector));\r\n    } else if ((selector as JQuery).jquery) {\r\n      return (selector as JQuery).toArray();\r\n    } else {\r\n      return Array.from(selector);\r\n    }\r\n  }\r\n\r\n  static locale(locale: string, localization: SpectrumLang) {\r\n    this.localization[locale] = localization;\r\n    return this;\r\n  }\r\n\r\n  static registerJQuery($: JQueryStatic) {\r\n    registerJQueryPlugin($);\r\n  }\r\n\r\n  constructor(ele: HTMLElement, options: Partial<SpectrumOptions> = {}) {\r\n    this.spectrum = spectrum(ele, options);\r\n    this.ele = ele;\r\n    this.options = options;\r\n  }\r\n\r\n  get id(): number {\r\n    return this.spectrum.id;\r\n  }\r\n\r\n  get container(): HTMLElement {\r\n    // @ts-ignore\r\n    if (!this.ele.__spectrum) {\r\n      return this.ele;\r\n    }\r\n\r\n    return this.spectrum.container;\r\n  }\r\n\r\n  show() {\r\n    this.spectrum.show();\r\n    return this;\r\n  }\r\n\r\n  hide() {\r\n    this.spectrum.hide();\r\n    return this;\r\n  }\r\n\r\n  toggle() {\r\n    this.spectrum.toggle();\r\n    return this;\r\n  }\r\n\r\n  reflow() {\r\n    this.spectrum.reflow();\r\n    return this;\r\n  }\r\n\r\n  option(): SpectrumOptions;\r\n  option<T extends keyof SpectrumOptions>(optionName?: T): SpectrumOptions[T];\r\n  option<T extends keyof SpectrumOptions>(optionName: T, optionValue: SpectrumOptions[T]): Spectrum\r\n  option<T extends keyof SpectrumOptions>(optionName?: T, optionValue?: SpectrumOptions[T]): any {\r\n    return this.spectrum.option(optionName, optionValue);\r\n  }\r\n\r\n  enable() {\r\n    this.spectrum.enable();\r\n    return this;\r\n  }\r\n\r\n  disable() {\r\n    this.spectrum.disable();\r\n    return this;\r\n  }\r\n\r\n  offset(coord: OffsetCSSOptions) {\r\n    this.spectrum.offset(coord);\r\n    return this;\r\n  }\r\n\r\n  set(color: ColorInput, ignoreFormatChange: boolean = false) {\r\n    this.spectrum.set(color, ignoreFormatChange);\r\n    return this;\r\n  }\r\n\r\n  get(): ColorInput {\r\n    return this.spectrum.get();\r\n  }\r\n\r\n  destroy() {\r\n    this.destroyInnerObject();\r\n    // @ts-ignore\r\n    delete this.ele.__spectrum;\r\n    return this;\r\n  }\r\n\r\n  rebuild(options?: Partial<SpectrumOptions>) {\r\n    this.destroyInnerObject();\r\n    if (options) {\r\n      this.options = Object.assign({}, this.options, options);\r\n    }\r\n    this.spectrum = spectrum(this.ele, this.options);\r\n    return this;\r\n  }\r\n\r\n  private destroyInnerObject() {\r\n    this.spectrum.destroy();\r\n    this.off();\r\n  }\r\n\r\n  listeners(eventName: string) {\r\n    return this.eventListeners[eventName] || [];\r\n  }\r\n\r\n  on(\r\n    eventName: string,\r\n    listener: SpectrumListener,\r\n    options: AddEventListenerOptions|undefined = undefined\r\n  ): Function {\r\n    this.ele.addEventListener(eventName, listener, options);\r\n\r\n    this.eventListeners[eventName] = this.eventListeners[eventName] || [];\r\n\r\n    this.eventListeners[eventName].push(listener);\r\n\r\n    return () => {\r\n      this.off(eventName, listener);\r\n    };\r\n  }\r\n\r\n  once(\r\n    eventName: string,\r\n    listener: SpectrumListener,\r\n    options: AddEventListenerOptions|undefined = undefined\r\n  ): Function {\r\n    const cancel = this.on(\r\n      eventName,\r\n      (e) => {\r\n        listener(e);\r\n\r\n        cancel();\r\n      },\r\n      options\r\n    );\r\n\r\n    return cancel;\r\n  }\r\n\r\n  off(eventName: string = undefined, listener: EventListener|SpectrumListener|undefined = undefined) {\r\n    if (eventName && !this.eventListeners[eventName]) {\r\n      return;\r\n    }\r\n\r\n    if (!eventName) {\r\n      this.eventListeners = {};\r\n      return;\r\n    }\r\n\r\n    if (listener) {\r\n      this.eventListeners[eventName] = this.eventListeners[eventName]\r\n        .filter((l) => l === listener);\r\n\r\n      this.ele.removeEventListener(eventName, listener);\r\n    } else {\r\n      for (const listener of this.eventListeners[eventName]) {\r\n        this.ele.removeEventListener(eventName, listener);\r\n      }\r\n\r\n      this.eventListeners[eventName] = [];\r\n    }\r\n  }\r\n}\r\n\r\n// @ts-ignore\r\nconst jQuery = window.jQuery;\r\n\r\nif (jQuery) {\r\n  registerJQueryPlugin(jQuery);\r\n}\r\n\r\nfunction registerJQueryPlugin($: any) {\r\n  // @ts-ignore\r\n  $.fn.spectrum = function (action: string | undefined | Partial<SpectrumOptions> = undefined, ...args) {\r\n    if (typeof action === \"string\") {\r\n      let returnValue = this;\r\n      this.each(function () {\r\n        const spect = this.__spectrum;\r\n\r\n        if (spect) {\r\n          const method = spect[action];\r\n\r\n          if (!method) {\r\n            throw new Error(\"Spectrum: no such method: '\" + action + \"'\");\r\n          }\r\n\r\n          if (action === \"get\") {\r\n            returnValue = spect.get();\r\n          } else if (action === \"container\") {\r\n            returnValue = $(spect.container);\r\n          } else if (action === \"option\") {\r\n            returnValue = spect.option.apply(spect, args);\r\n          } else if (action === \"destroy\") {\r\n            spect.destroy();\r\n          } else {\r\n            spect[action](...args);\r\n          }\r\n        }\r\n      });\r\n\r\n      return returnValue;\r\n    }\r\n\r\n    // Initializing a new instance of spectrum\r\n    return this.each(function () {\r\n      const options: SpectrumOptions = $.extend({}, $(this).data(), action);\r\n      // Infer default type from input params and deprecated options\r\n      if (!$(this).is('input')) {\r\n        options.type = 'color';\r\n      } else if (options.type == \"flat\") {\r\n        options.type = 'flat';\r\n      } else if ($(this).attr('type') == 'color') {\r\n        options.type = 'color';\r\n      } else {\r\n        options.type = options.type || 'component';\r\n      }\r\n\r\n      if (Spectrum.hasInstance(this)) {\r\n        const sp = Spectrum.getInstance(this);\r\n\r\n        sp.options = options;\r\n        sp.rebuild();\r\n      } else {\r\n        Spectrum.getInstance(this, options);\r\n      }\r\n    });\r\n  };\r\n\r\n  $.fn.spectrum.load = true;\r\n  $.fn.spectrum.loadOpts = {};\r\n  $.fn.spectrum.draggable = draggable;\r\n  $.fn.spectrum.defaults = defaultOpts;\r\n  $.fn.spectrum.localization = Spectrum.localization;\r\n  $.fn.spectrum.palette = [];\r\n\r\n  $.fn.spectrum.processNativeColorInputs = function () {\r\n    const colorInputs = $(\"input[type=color]\");\r\n    if (colorInputs.length) {\r\n      colorInputs.spectrum({\r\n        preferredFormat: \"hex6\"\r\n      });\r\n    }\r\n  };\r\n}\r\n"],"names":["insertAfter","existingNode","newNode","_a","wrap","ele","wrapper","outerWidthWithMargin","style","html","doc","div","throttle","func","wait","debounce","timeout","context","args","throttler","addClass","className","classes","c","removeClass","toggleClass","state","emit","eventName","detail","event","eventDelegate","selector","listener","payload","e","setElementOffset","elem","options","curPosition","curTop","curLeft","calculatePosition","position","curElem","props","curOffset","getElementOffset","curCSSTop","curCSSLeft","getElementPosition","k","el","box","docElem","top","left","marginTop","marginLeft","defaultOpts","noop","spectrums","replaceInput","markup","paletteTemplate","p","color","opts","i","current","tiny","tinycolor","formattedString","swatchStyle","hideAll","instanceOptions","element","parts","Spectrum","bind","spectrum","type","flat","showSelectionPalette","localStorageKey","theme","callbacks","resize","reflow","visible","isDragging","dragWidth","dragHeight","dragHelperHeight","slideHeight","alphaWidth","alphaSlideHelperWidth","slideHelperHeight","currentHue","currentSaturation","currentValue","currentAlpha","palette","paletteArray","paletteLookup","selectionPalette","maxSelectionSize","draggingClass","abortNextInputChange","shiftMovementDirection","container","boundElement","disabled","pickerContainer","dragger","dragHelper","slider","slideHelper","alphaSliderInner","alphaSlider","alphaSlideHelper","textInput","paletteContainer","initialColorContainer","cancelButton","clearButton","chooseButton","toggleButton","isInput","isInputTypeColor","shouldReplace","replacer","offsetElement","previewElement","initialColor","colorOnShow","currentPreferredFormat","clickoutFiresChange","isEmpty","allowEmpty","originalInputContainer","colorizeElement","colorizeElementInitialColor","colorizeElementInitialBackground","thisId","label","show","applyOptions","j","rgb","offsetElementStart","initialize","inputStyle","cssProp","addOn","appendTo","updateSelectionPaletteFromStorage","disable","input","setFromTextInput","hide","revert","move","updateOriginalInput","isValid","draggable","dragX","dragY","dragStart","dragStop","oldDragX","oldDragY","setSaturation","setValue","set","updateUI","addColorToSelectionPalette","paletteElementClick","_b","paletteEvents","paletteEvent","localStorage","oldPalette","getUniqueSelectionPalette","unique","drawPalette","currentColor","get","drawInitial","initial","value","toggle","onkeydown","clickout","ignoreFormatChange","newColor","newHsv","updateHelperLocations","flatColor","format","realColor","displayColor","realHex","realRgb","realAlpha","textColor","alphaX","slideY","fireCallback","hasChanged","getOffset","destroy","spect","option","optionName","optionValue","enable","setOffset","coord","picker","dpWidth","dpHeight","inputHeight","viewWidth","viewHeight","offset","offsetLeft","offsetTop","obj","slice","onmove","onstart","onstop","dragging","maxHeight","maxWidth","hasTouch","duringDragEvents","prevent","stop","t0","pageX","pageY","start","__publicField","msg","instances","locale","localization","$","registerJQueryPlugin","cancel","l","jQuery","action","returnValue","sp","colorInputs"],"mappings":"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"}